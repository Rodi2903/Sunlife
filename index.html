<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Statement of Account Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 20px;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .header {
            background: #1e3a63;
            color: white;
            padding: 10px;
            text-align: center;
            border-radius: 8px 8px 0 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #1e3a63;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2>Statement of Account</h2>
        </div>

        <label>Policy Anniversary: <input type="date" id="policyAnniversary"></label><br><br>
        <label>Total Paid for Whole Duration: <input type="number" id="totalPaid"></label><br><br>
        <label>Premium Amount: <input type="number" id="premiumAmount"></label><br><br>
        <label>Mode of Payment: 
            <select id="modeOfPayment">
                <option value="yearly">Yearly</option>
                <option value="quarterly">Quarterly</option>
                <option value="monthly">Monthly</option>
            </select>
        </label><br><br>

        <button onclick="generateSOA()">Generate Statement</button>

        <div id="output"></div>
    </div>

    <script>
        function generateSOA() {
            const policyAnniversary = new Date(document.getElementById('policyAnniversary').value);
            const totalPaid = parseFloat(document.getElementById('totalPaid').value);
            const premiumAmount = parseFloat(document.getElementById('premiumAmount').value);
            const modeOfPayment = document.getElementById('modeOfPayment').value;

            let output = `<h3>Account Summary</h3>`;
            output += `<p><strong>Policy Anniversary:</strong> ${policyAnniversary.toDateString()}</p>`;
            output += `<p><strong>Total Paid for Whole Duration:</strong> PHP ${totalPaid.toFixed(2)}</p>`;

            const currentDate = new Date();
            let balance = 0;
            let coverageRows = '';

            for (let year = policyAnniversary.getFullYear(); year <= currentDate.getFullYear(); year++) {
                if (year < currentDate.getFullYear()) {
                    coverageRows += `<tr><td>${year}-09-15 to ${year + 1}-09-15</td><td>PHP ${(modeOfPayment === 'yearly' ? premiumAmount : premiumAmount * 4).toFixed(2)}</td><td>PAID</td></tr>`;
                } else {
                    const startYear = `${year}-09-15`;
                    let endYear = `${year + 1}-09-15`;

                    if (modeOfPayment === 'quarterly') {
                        const quarters = [3, 6, 9, 12];
                        for (let i = 0; i < quarters.length; i++) {
                            const start = new Date(year, quarters[i] - 3, 15);
                            const end = new Date(year, quarters[i], 15);
                            const amountDue = premiumAmount;
                            const paidStatus = totalPaid >= amountDue ? 'PAID' : 'NOT PAID';
                            if (paidStatus === 'NOT PAID') balance += amountDue;
                            coverageRows += `<tr><td>${start.toDateString()} to ${end.toDateString()}</td><td>PHP ${amountDue.toFixed(2)}</td><td>${paidStatus}</td></tr>`;
                            totalPaid -= amountDue;
                        }
                    } else if (modeOfPayment === 'monthly') {
                        for (let month = 0; month < 12; month++) {
                            const start = new Date(year, month, 15);
                            const end = new Date(year, month + 1, 15);
                            const amountDue = premiumAmount;
                            const paidStatus = totalPaid >= amountDue ? 'PAID' : 'NOT PAID';
                            if (paidStatus === 'NOT PAID') balance += amountDue;
                            coverageRows += `<tr><td>${start.toDateString()} to ${end.toDateString()}</td><td>PHP ${amountDue.toFixed(2)}</td><td>${paidStatus}</td></tr>`;
                            totalPaid -= amountDue;
                        }
                    } else {
                        const amountDue = premiumAmount;
                        const paidStatus = totalPaid >= amountDue ? 'PAID' : 'NOT PAID';
                        if (paidStatus === 'NOT PAID') balance += amountDue;
                        coverageRows += `<tr><td>${startYear} to ${endYear}</td><td>PHP ${amountDue.toFixed(2)}</td><td>${paidStatus}</td></tr>`;
                    }
                }
            }

            output += `<table><thead><tr><th>Coverage Date</th><th>Premium Amount</th><th>Status</th></tr></thead><tbody>${coverageRows}</tbody></table>`;

            if (balance > 0) {
                output += `<h3>Balance: PHP ${balance.toFixed(2)}</h3>`;
            }

            document.getElementById('output').innerHTML = output;
        }
    </script>
</body>
</html>
